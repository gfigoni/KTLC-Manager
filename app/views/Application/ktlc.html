#{extends 'main.html' /}
#{set title:'KTLC #'+ktlc?.number /}
#{set page:'ktlc' /}

#{if ktlc}
<div id="content_top">
    <ul>
        <li>#{a @Application.ktlc(ktlc.number)}KTLC #${ktlc.number} <span>${ktlc.date.format()}</span>#{/a}</li>
    </ul>
</div>
<div id="main">
    <div class="map">
        #{list ktlc.races, as:'race'}
        <ul>
            <li>${race.map.name}</li>
            <li>by ${race.map.author.name}</li>
            <li>${race.map.environment}</li>
        </ul>
        #{/list}
    </div>
    <div class="separator"></div>
    <div id="content">
        <div class="content_box">
            <ul class="menu home">
                <li class="rank menu home">Rank</li>
                <li class="player menu home">Player</li>
                <li class="score menu home">Score</li>
                <li class="race menu home">Nb Races</li>
            </ul>
            #{list ktlc.results, as:'result'}
            <ul class="home">
                <li class="rank">${result.rank}</li>
                <li class="player">#{a @Application.player(result.player.login)}${result.player.name}#{/a}</li>
                <li class="score">${result.score}</li>
                <li class="race">${result.nbRaces}</li>
            </ul>
            #{/list}
        </div>
    </div>
    <div class="cleaner"></div>
    <div id="race">
        #{list items:ktlc.races, as:'race'}
        <div class="race_content">
            <div class="racemap">
                <ul>
                    <li>${race.map.name}</li>
                    <li>by ${race.map.author.name}</li>
                    <li>${race.map.environment}</li>
                </ul>
            </div>
            <div class="raceresult">
                <ul class="menu">
                    <li class="menu rank">Rank</li>
                    <li class="menu player">Player</li>
                    <li class="menu score">Score</li>
                    <li class="menu round">Round</li>
                </ul>
                #{list race.results, as:'result'}
                <ul>
                    <li class="rank">${result.rank}</li>
                    <li class="player">#{a @Application.player(result.player.login)}${result.player.name}#{/a}</li>
                    <li class="score">${result.score}</li>
                    <li class="round">${result.roundsCount}</li>
                </ul>
                #{/list}
            </div>
        </div>
        #{/list}
    </div>
    <div class="cleaner"></div>
</div>
#{/if}

#{else}
<div id="content_top">
    <ul>
        <li><h1><a href="#">No KTLC</a></h1></li>
    </ul>
</div>
<div id="main">
    <div id="content">
        <div class="content_box">
            This KTLC doesn't exist
        </div>
    </div>
    <div class="cleaner"></div>
</div>
#{/else}